/*
 * Copyright 2014-2015 Hippo B.V. (http://www.onehippo.com)
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

.fixed-width (@width) {
  width: @width;
  min-width: @width;
  max-width: @width;
}

.fixed-height (@height) {
  height: @height;
  min-height: @height;
  max-height: @height;
}

.hippo-list-documents {
  background-color: @body-bgcolor;
  border-collapse: collapse;

  // keep the styling that affect width in sync in the thead and tbody to ensure correctly aligned table headers
  > thead > tr > th,
  > tbody > tr > td {
    padding: @doclist-padding-top-bottom @doclist-padding-left-right;

    // border between columns
    border-left: 1px solid transparent;
    &:first-child {
      border-left: 0;
    }

    // column types
    &.doclisting-icon {
      .fixed-width(32px);
      padding: @doclist-padding-icon;
      + .doclisting-name {
        border-left: 0;
        padding-left: 0;
      }
    }
    &.doclisting-name {
      width: 100%;
      min-width: 10px;
    }
    &.doclisting-type {
      .fixed-width(110px);
    }
    &.doclisting-state {
      .fixed-width(51px);

      > span {
        display: block;
        height: 16px;
      }

      .state-new {
        background: url("@{images}/icons/state-offline-tiny.svg") no-repeat left;
      }
      .state-live {
        background: url("@{images}/icons/state-live-tiny.svg") no-repeat left;
      }
      .state-changed {
        background: url("@{images}/icons/state-changed-tiny.svg") no-repeat left;
      }

    }
    &.doclisting-date {
      .fixed-width(140px);
    }
    &.doclisting-lastmodified-by {
      .fixed-width(120px);
      &:last-child {
        .fixed-width(200px);
      }
    }
    &.doclisting-translations {
      .fixed-width(120px);
      padding-top: 0;
      padding-bottom: 0;

      .hippo-translation-doclisting > ul {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        list-style-type: none;
      }
      .hippo-translation-doclisting > ul > li {
        display: block;
        padding-right: 8px;
        height: 16px;
      }
    }
    &.doclisting-size {
      .fixed-width(80px);
    }
    &.doclisting-mimetype {
      .fixed-width(130px);
      span {
        word-wrap: none;
        text-overflow: ellipsis;
      }
    }
    &.doclisting-width {
      .fixed-width(75px);
    }
    &.doclisting-height {
      .fixed-width(75px);
    }
  }

  > thead {
    color: @doclist-head-color;
    background-color: @doclist-head-bgcolor;

    > tr {
      display: block;
      position: relative;
      width: 100%;
      height: @doclist-head-height;

      > th {
        font-size: @font-size-large;
        line-height: @line-height-computed;
        border-color: @doclist-head-border-color;
        &:hover {
          color: @aqua;
        }
      }

      .hippo-list-order-ascending,
      .hippo-list-order-descending,
      .hippo-list-order-none {
        cursor: pointer;
      }

      .hippo-list-order-ascending > span {
        padding-right: 16px;
        color: @doclist-head-sorted-color;
        background: url("@{images}/icons/sort-ascending-tiny.svg") 100% 100% no-repeat;
      }

      .hippo-list-order-descending > span {
        padding-right: 16px;
        color: @doclist-head-sorted-color;
        background: url("@{images}/icons/sort-descending-tiny.svg") 100% 100% no-repeat;
      }

      .doclisting-icon {
        background: no-repeat 50% 50%;
        > span {
          background: none;
        }
        &.hippo-list-order-none {
          background-image: url("@{images}/icons/stateorder-none-tiny.svg");
          &:hover {
            background-image: url("@{images}/icons/stateorder-hover-tiny.svg");
          }
        }
        &.hippo-list-order-ascending {
          background-image: url("@{images}/icons/stateorder-down-tiny.svg");
        }
        &.hippo-list-order-descending {
          background-image: url("@{images}/icons/stateorder-up-tiny.svg");
        }
      }
    }
  }

  > tbody {
    display: block;
    overflow-x: hidden;
    overflow-y: auto;
    width: 100%;

    > tr {
      // prevent IE10 from setting tbody height on all rows
      height: auto;

      border-top: 1px solid @doclist-row-separator-color;

      > td {

        // ensure icons smaller than 32px are centered in a 32x32px box
        &.doclisting-icon span {
          .fixed-height(32px);
          display: flex;
          justify-content: center;
          align-items: center;
        }
      }

      > td:not(.doclisting-icon) > span span {
        // show only 2 lines of text, but allow icons to shift
        // out of their box (e.g. for stacked document state icons)
        display: block;
        overflow: hidden;
        max-height: 2 * @line-height-computed;
      }

      .link {
        cursor: pointer;
      }

      &:first-child {
        border-top: none;
      }
    }

    .hippo-list-selected {

      border-top-color: transparent;
      background-color: @doclist-row-selected-bgcolor;
      color: @doclist-row-selected-color;

      svg {
        fill: @doclist-row-selected-color;
      }

      .hi-state-new {
        .hi-shape-circle {
          fill: @doclist-row-selected-color;
        }
        .hi-shape-stripe {
          fill: @doclist-row-selected-bgcolor;
        }
      }

      .hi-state-live {
        .hi-shape-circle {
          fill: @doclist-row-selected-color;
        }
        .hi-shape-checkmark {
          fill: @doclist-row-selected-bgcolor;
        }
      }

      .hi-state-changed {
        .hi-shape-circle,
        .hi-shape-triangle,
        .hi-shape-triangle-border {
          fill: @doclist-row-selected-color;
        }
        .hi-shape-checkmark,
        .hi-shape-exclamation-mark {
          fill: @doclist-row-selected-bgcolor;
        }
      }

      + tr {
        border-top-color: transparent;
      }
    }
  }

  > tfoot > tr {
    height: @doclist-foot-height;

    &.hippo-list-paging {

      > td {
        position: relative;

        .paging-container {
          border-top: 1px solid @doclist-row-separator-color;
          width: 100%;
          height: @doclist-foot-height;
          display: flex;
          justify-content: center;
          align-items: center;

          .paging-navigator {
            font-size: @font-size-small;
            height: @doclist-paging-button-size;

            em, a {
              display: inline-block;
              width: @doclist-paging-button-size - 2;
              height: @doclist-paging-button-size - 2;
              line-height: @doclist-paging-button-size - 2;
              text-align: center;
              border: 1px solid transparent;
            }

            a {
              background-color: @doclist-paging-button-fill;
              border-color: @doclist-paging-button-stroke;
              border-radius: 2px;
              color: @text-color;
              &:hover {
                text-decoration: none;
                color: @doclist-paging-button-hover-color;
                background-color: @doclist-paging-button-hover-fill;
              }
            }
          }
        }

        .paging-label {
          position: absolute;
          top: 0;
          right: 0;
          font-size: @font-size-small - 1;
          height: @font-size-base;
          padding-top: (@doclist-foot-height - @font-size-base) / 2;
          padding-right: @doclist-padding-left-right;
        }
      }
    }
  }
}

// expand/collapse
.toggle-button {
  display: flex;
  position: absolute;
  top: 0;
  right: 0;
  float: right;
  z-index: 100;

  > a {
    display: flex;
    justify-content: center;
    align-items: center;
    box-sizing: border-box;
    width: 16px;
    margin: 0 4px;
    height: @doclist-head-height;
    cursor: pointer;
    border-top: 2px solid transparent;
    border-bottom: 2px solid transparent;

    &:last-child {
      margin-right: 12px;
    }

    &:hover .hi {
      fill: @aqua;
    }
  }
}

.yui-layout-collapsed .hippo-list-documents .hippo-list-paging {
  // hide all buttons except the current page indicator
  .paging-navigator .goto a {
    display: none;
  }
  .paging-label {
    visibility: hidden;
  }
}
