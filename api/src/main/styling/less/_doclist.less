/*
 * Copyright 2014 Hippo B.V. (http://www.onehippo.com)
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

.fixed-width (@width) {
  width: @width;
  min-width: @width;
  max-width: @width;
}

.fixed-height (@height) {
  height: @height;
  min-height: @height;
  max-height: @height;
}

.hippo-list-documents {
  background-color: @body-bgcolor;
  border-collapse: collapse;

  // keep the styling that affect width in sync in the thead and tbody to ensure correctly aligned table headers
  > thead > tr > th,
  > tbody > tr > td {
    padding: @doclist-padding;

    /* column types */
    &.doclisting-icon {
      .fixed-width(32px);
      + .doclisting-name {
        padding-left: 0;
      }
    }
    &.doclisting-name {
      width: 100%;
      min-width: 10px;
    }
    &.doclisting-type {
      .fixed-width(110px);
    }
    &.doclisting-state {
      .fixed-width(51px);

      > span {
        display: block;
        height: 16px;
      }

      .state-new {
        background: url("@{images}/icons/state-offline-tiny.svg") no-repeat left;
      }
      .state-live {
        background: url("@{images}/icons/state-live-tiny.svg") no-repeat left;
      }
      .state-changed {
        background: url("@{images}/icons/state-changed-tiny.svg") no-repeat left;
      }

    }
    &.doclisting-date {
      .fixed-width(140px);
    }
    &.doclisting-lastmodified-by {
      .fixed-width(120px);
    }
    &.doclisting-translations {
      .fixed-width(120px);
      padding-top: 0;
      padding-bottom: 0;

      .hippo-translation-doclisting > ul {
        display: block;
        list-style-type: none;
      }
      .hippo-translation-doclisting > ul > li {
        display: inline;
        padding-right: 4px;
        white-space: nowrap;
      }
    }
    &.doclisting-size {
      .fixed-width(80px);
    }
    &.doclisting-mimetype {
      .fixed-width(130px);
      span {
        word-wrap: none;
        text-overflow: ellipsis;
      }
    }
  }

  > thead {
    color: @doclist-head-color;
    background-color: @doclist-head-bgcolor;

    > tr {
      display: block;
      position: relative;
      width: 100%;
      height: @doclist-head-height;

      > th {
        height: @doclist-head-height - (2 * @doclist-padding);
        font-size: @font-size-large;
      }

      .hippo-list-order-ascending,
      .hippo-list-order-descending,
      .hippo-list-order-none {
        cursor: pointer;
      }

      .hippo-list-order-ascending {
        > span {
          padding-right: 16px;
          color: @doclist-head-sorted-color;
          background: url("@{images_legacy}/icons/arrow-sort-down-16.png") no-repeat right;
        }
      }

      .hippo-list-order-descending {
        > span {
          padding-right: 16px;
          color: @doclist-head-sorted-color;
          background: url("@{images_legacy}/icons/arrow-sort-up-16.png") center right no-repeat;
        }
      }
    }
  }

  > tbody {
    display: block;
    overflow-x: hidden;
    overflow-y: auto;
    width: 100%;

    > tr {
      // prevent IE10 from setting tbody height on all rows
      height: auto;

      border-top: 1px solid @doclist-row-separator-color;

      > td {

        // ensure icons smaller than 32px are centered in a 32x32px box
        &.doclisting-icon span {
          .fixed-height(32px);
          display: flex;
          justify-content: center;
          align-items: center;
        }
      }

      > td:not(.doclisting-icon) > span span {
        // show only 2 lines of text, but allow icons to shift
        // out of their box (e.g. for stacked document state icons)
        display: block;
        overflow: hidden;
        max-height: ceil(2.1 * @line-height-computed);
      }

      .link {
        cursor: pointer;
      }

      &:first-child {
        border-top: none;
      }
    }

    .hippo-list-selected {

      border-top-color: transparent;
      background-color: @doclist-row-selected-bgcolor;
      color: @doclist-row-selected-color;

      svg {
        fill: @doclist-row-selected-color;
      }

      .hi-state-new {
        .hi-shape-circle {
          fill: @doclist-row-selected-color;
        }
        .hi-shape-stripe {
          fill: @doclist-row-selected-bgcolor;
        }
      }

      .hi-state-live {
        .hi-shape-circle {
          fill: @doclist-row-selected-color;
        }
        .hi-shape-checkmark {
          fill: @doclist-row-selected-bgcolor;
        }
      }

      .hi-state-changed {
        .hi-shape-circle,
        .hi-shape-triangle,
        .hi-shape-triangle-border {
          fill: @doclist-row-selected-color;
        }
        .hi-shape-checkmark,
        .hi-shape-exclamation-mark {
          fill: @doclist-row-selected-bgcolor;
        }
      }

      + tr {
        border-top-color: transparent;
      }
    }
  }

  > tfoot > tr {
    height: @doclist-foot-height;

    &.hippo-list-paging {

      > td {
        .paging-container {
          border-top: 1px solid @doclist-row-separator-color;
          width: 100%;
          height: @doclist-foot-height - 1;
          display: flex;
          justify-content: center;
          align-items: center;

          .paging-navigator {
            font-size: @font-size-small;

            em, a {
              border: 1px solid transparent;
              padding: 2px 5px;
            }

            a {
              background-color: @doclist-paging-button-fill;
              border-color: @doclist-paging-button-stroke;
              border-radius: 2px;
              color: @text-color;
              &:hover {
                text-decoration: none;
                color: @doclist-paging-button-hover-color;
                background-color: @doclist-paging-button-hover-fill;
              }
            }

          }
          .paging-label {
            position: absolute;
            font-size: @font-size-tiny;
            height: @font-size-base;
            padding-top: (@doclist-foot-height - @font-size-base) / 2;
            right: @doclist-padding;
          }
        }
      }
    }
  }
}

// expand/collapse
.toggle-button {
  display: block;
  position: absolute;
  top: 0;
  right: 0;
  float: right;
  z-index: 100;

  > a {
    display: block;
    width: @doclist-head-height;
    height: @doclist-head-height;
    cursor: pointer;
    background-position: center;
    background-repeat: no-repeat;
  }
}

.yui-layout-expanded .toggle-button a {
  background-image: url("@{images}/icons/collapse-tiny.svg");
}

.yui-layout-collapsed {

  .toggle-button a {
    background-image: url("@{images}/icons/expand-tiny.svg");
  }

  .hippo-list-documents {
    // hide all buttons except the current page indicator
    .paging-navigator .goto a {
      display: none;
    }
    .paging-label {
      visibility: hidden;
    }
  }
}
